\section{Discussion}
\label{sec:dicsussion}

% RQ1 How can we best calculate the distance between two attack trees?
% RQ2 Are these methods of attack tree distance valid?
% RQ3 What are the industry applications of attack tree distance?

\subsection{RQ1: Best Measure}

We have described five different measures of comparison between attack trees. As we see in Table~\ref{tab:counterexamples}, none of our distance measures exactly match the intuitive distance. We can confidently say that establishing distance based on underlying multiset semantics (multiset distance) and establishing distance based on a comparison of various measures is inadequate as an effective means of distance. This is further seen in Table~\ref{tab:requirmeent-suitability}, where statistical comparison and multiset distance only fully meet 3 and 5 of the 9 requirements, respectively.

Most promising are the established tree edit distance (TED) and newly developed radical distance (RD). TED is a well-established measure of distance between trees, and as such, it is not surprising that it meets almost all requirements. The only requirement it does not meet is the ability to ignore difference caused by the order of children being changed. This is seen explicitly in Table~\ref{tab:counterexamples}. TED on unordered trees is an active area of research, and as we described in Section~\ref{sec:related-work}, much of the research into unordered TED relies on exact equivalence between nodes. This is not practical for attack trees, as the labels of nodes are not identical, but should still be considered equivalent. Further research will be needed to establish unordered TED using semantic similarity between node labels to define node equivalence. Overall, TED meets 8 of our 9 requirements.

Similar to TED is our novel measure of RD. RD's allows Overall, RD fully meets 8 of our 9 requirements; for the remaining requirement of node position, RD partially meets this requirement, as it takes into account the position of nodes w.r.t. their parents but does not consider the position of the radical to the tree as a whole. When compared to our defined counterexamples in Table~\ref{tab:counterexamples}, RD matches the intuitive distance for nearly all examples. RD only does not meet expectation when the number of radicals between two trees differs.

\begin{table*}[ht!]
    \resizebox{.9\linewidth}{!}{%
    \begin{tabular}{@{}lccccccccc@{}}
                \toprule
    \shortstack{\textbf{Distance}\\\textbf{Measure}} & \shortstack{\req{1}\\\textbf{Simple}} & \shortstack{\req{2}\\\textbf{Unfiltered}} & \shortstack{\req{3}\\\textbf{Effect Size}} & \shortstack{\req{4}\\\textbf{Description}} & \shortstack{\req{5}\\\textbf{Unordered}} & \shortstack{\req{6}\\\textbf{Labels}} & \shortstack{\req{6}\\\textbf{Refinements}} & \shortstack{\req{6}\\\textbf{Position}} & \shortstack{\req{7}\\\textbf{Metric}} \\ \midrule
    \textbf{Statistics}       & \Negate                & \Confirm\footnotemark[1]          & \Negate \footnotemark[2]        & \Confirm          &\Confirm   & \Negate                 & \Confirm           & \Negate                   & \Negate\footnotemark[2]                    \\
    \textbf{TED}              & \Confirm      & \Confirm          & \Confirm           & \Confirm          & \Negate & \Confirm      & \Confirm           & \Confirm        & \Confirm      \\
    \textbf{LD}               & \Confirm      & \Confirm          & \Confirm           & \Partial \footnotemark[3]                    &\Confirm   & \Confirm      & \Negate                      & \Negate                   & \Confirm      \\
    \textbf{RD}               & \Confirm      & \Confirm          & \Confirm           & \Confirm          &\Confirm   & \Confirm      & \Confirm           & \Partial \footnotemark[4]     & \Confirm      \\
    \textbf{MSD}              & \Confirm      & \Confirm          & \Negate\footnotemark[5]                       &  \Partial  \footnotemark[3]                  &\Confirm   & \Confirm      & \Negate                      & \Negate                   & \Confirm                 \\ \bottomrule
            \end{tabular}
    }
    \caption{A comparison of the different distance measures and their suitability w.r.t. the requirements defined in Section~\ref{ssec:requirements}\\
        \footnotesize
        1: As the statistic measure does not examine labels, it is equivalently applicable to unfiltered trees.\\
        2: Without a simple definition of distance (requirement 1), this requirement is functionally impossible to meet\\
        3: These measures exclude significant information, as such their edit descriptions do not offer fully suitable descriptions of difference.\\% This requirement is partially met.\\
        4: Radical distance incorporates the position of nodes w.r.t. their parent, however, it does not incorporate the position of the radical within the whole attack tree. \\ %This requirement is partially met.
        5: Multiset distance only measures the leaf nodes, which is unable to consider the magnitude of the distance between two trees.
        \normalsize}
    \label{tab:requirmeent-suitability}
    \end{table*}

\subsection{RQ2: Validity}

To start, we apply tree edit distance, which is a well established and documented mechanism to describe the distance between two trees~\cite{Zhang_Shasha_1989,zhang_editing_1992,akutsu_tree_2021,pawlik_rted_2011,mcvicar_sumoted_2016}. If we can show the distance measures we suggest, label distance, radical distance, and multiset distance, behave similarly to tree edit distance, we can infer that these distance measures are similarly valid. In Figure~\ref{fig:semsim-at2}, we see distance measures for all distance measures as applied to a dataset of trees that all have the same base tree, but have been extended differently by participants. This distance is averaged across all samples we have, and modified by a changing semantic similarity limit. This figure shows how different distance measures change with different semantic similarity limits. This gives us a mechanism to compare different distance measures, as if measures are fundamentally measuring trees similarly, then these lines should roughly correspond to each other. We can see in Figure~\ref{fig:semsim-at2} that the tree edit distance, radical distance and label distance are all remarkably similar, with the lines for these distances translated vertically on the $y$-axis. This suggests that these distance measures are fundamentally measuring the same thing, and as tree edit distance can be argued to be valid, similarly, both label and radical distance must likewise be valid.

Figure~\ref{fig:semsim-at1-2}

Our main contribution to tree distance is the novel technique of comparing components in DAGs by using semantic similarity. To our knowledge, all previous tree distance measurements have worked with either artificial data or with a ``clean'' dataset, which would entirely negate the need to assess node similarity by anything other than equivalence. We are the first to attempt to define tree distance for node labels that are not identical, but should still be considered equivalent. By applying this method to a series of attack trees that should be more or less equivalent, we can assess if this technique is valid. As described in Section~\NS{TODO: Add section reference}, the first attack tree that subjects drew was based on a provided written scenario. Subjects were instructed to include only information provided by the scenario, to include no additional information and to include all the information in the scenario. As such and as discussed in Section~\NS{TODO: Add section reference}, while we expect natural variations in these trees due to participants interpreting the scenario differently, missing information or organizing information different, ultimately the resulting trees should be fairly equivalent. As shown in Figure~\ref{fig:semsim-at1}, for semantic similarity limits  below 0.75, we see this expected equivalence. This suggests that our method is producing an output that is measuring the distance between two attack trees, and thus is valid.

To further validate our approach, we apply our distance measurements



We have shown that our method is able to calculate the distance between two attack trees, and that this distance is valid. We have also shown that this method can be used to compare attack trees in a real-world scenario, and that it can be used to identify similar attack trees.
 

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}



\subsection{RQ3: Industry Applications}



\subsubsection{Sharing Threat Intelligence}

Threat models are a recommended tool for threat analysis~\cite{andersonSecurityEngineeringGuide2020,schneierSecretsLiesDigital2000}. However, once these models are created, they may only be applicable to the analyst or the team of analysts that created them. Unlike other sources of threat intelligence, such as YARA Rules~\cite{naik2019cyberthreat,naik2020evaluating}, there is no means to share attack trees in this format.

In order to allow for attack trees to be shared as threat intelligence, two aspects are needed: a common structure and a means of comparison. The common structure has already been defined, in the ADTool XML Schema~\cite{kordy_adtool_2013}. This is an XML format used by ADTool, a tool to create Attack-Defense Trees, an extension of ATs. The ADTool XML Schema can be used to define attack trees, and as such, can be used as a common structure for sharing attack trees. The dataset of ATs we describe in Section~\ref{sec:results} is in this format. The second aspect is a means of comparison, which is what we have defined in this paper. It will be possible to publish attack trees in the ADTool XML Schema, and then compare the resulting trees using the distance measures we have defined. This will allow for the sharing of attack trees as threat intelligence, and the comparison of these trees to identify similar threats.

\subsubsection{Generative AI}

Applying generative AI to security is an active area of research. Distance measures are critical for using generative AI to create threat models in general, and attack trees specifically. By using a distance measure, we can compare the output of a generative AI to a set of known attack trees, and determine how similar the output is to the known attack trees. As we can control the form of the output of generative AI, we can have an AI tool output AT in the ADTool XML Schema, and then compare the resulting attacks to our own output or to a dataset.

Going further, in order to build and refine a generative AI tool to create attack trees, we need to define a cost function~\NS{TODO: cite something}. A cost function is necessary for training a model, as this is what the model will attempt to optimize for. Fundamental to this cost function is the ability to define distance, as we can offer a way to compare a generated solution to a ``ground truth''.

