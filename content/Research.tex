
\section{Research}

Our primary research goal is to determine a mechanism to calculate the distance between two attack trees. This is a novel problem, as attack trees contain the concept of refinements, and the application of tree edit distance to the cybersecurity domain has yet to be seen.

\subsection{Research Questions}

We posit the following research questions:

\begin{enumerate}
    \item[\RQ{1}] How can we best calculate the distance between two attack trees?
    \item[\RQ{2}] Is this method of attack tree distance valid?
    \item[\RQ{3}] What are the industry applications of attack tree distance?
\end{enumerate}

\subsection{Motivation}

\textit{This subsection may be removed in the final paper, but it helps to frame why we are doing this}.

Threat modeling seeks to organize threat information that aids in comprehension and analysis. \NS{cite andersion/schneier} Many attack trees are drawn by practitioners in the course of their work. However, most attack trees exist at the moment exist in a vacuum, they are created for a specific team or practitioner with diminished value beyond that scope. By developing a methodology for calculating the distance (or difference) between two attack trees, we can empower practitioners with a simple mechanism to compare their attack trees with those of others. This could be used to find attack trees that are similar, with the differences representing missing components and attack vectors, or to find differences in analysis. Given the increasing prevalence of LLMs and the application of LLMs to a wider array of fields, being able to compare self drawn attack trees to a large collection of machine generated attack trees would be a powerful tool for practitioners.



\subsection{Requirements}
\label{ssec:requirements}

The application of tree edit distance to attack trees requires a number of considerations. These considerations are as follows:

\subsubsection{Simple definition of difference}

We aim to establish some means by which we can say that some tree $T_A$ differs from some tree $T_B$ by some amount $x$. This description of difference should be simple and intuitive, such that a practitioner can understand the difference between two trees without needing to understand the underlying mathematics.

\subsubsection{Applicable to unfiltered trees}

As the ultimate goal is to find a mechanism that is usable for attack trees that are drawn by practitioners. As such, the distance calculation must be effective and meaningful to trees that are not filtered or otherwise processed. 

\subsubsection{Effect size}

This distance between two attack trees should be indicative of how different the two trees. 


\subsubsection{Detailed description of difference}

The calculation of a distance must produce a description of the difference between two trees. This description should be human readable and should be able to be used to inform a practitioner of the differences between two trees.

\subsubsection{Incorporates all elements of attack trees}

The distance calculation must incorporate all elements of attack trees. This includes the refinement  and the labels of nodes, for all nodes in the tree.

\subsubsection{Difference is a metric}

The distance between two attack trees must be a metric. That is to say, the distance between two attack trees must be non-negative, symmetric, and satisfy the triangle inequality.



\subsection{Assumptions}

We make a series of assumptions in our comparisons of attack trees. These assumptions are as follows:  

\subsubsection{Attack tree size}

We assume that attack trees are of a relatively small size. In a previous study on self drawn attack defense trees, the largest attack trees were on the order of 50 nodes. While this is large for a human to comprehend, on the scale of data structures, this is miniscule. As such, it should be unnecessary to optimize for complexity, as attack trees, especially human drawn attack trees, do not reach the size where complexity becomes a significant issue. Even in the case of a large dataset of attack trees, due to the relatively small size of each individual attach tree, the complexity of a distance calculation should not impact computability. Therefore, we so not consider computational complexity as a requirement for our distance measurement.


% \subsubsection{Refinement Awareness}
% \label{sssec:refinement}

% The primary difference between attack trees and most directed acyclic graphs (DAGs) are the presence of refinements, or the given relationship between children. This is a critical part of the attack tree structure and must be included in the tree edit distance algorithm.

% \subsubsection{Semantic Label Similarity}
% \label{sssec:label-similarity}

% In early iterations of tree edit distance problems, node labels were said to be equivalent if the labels were identical. However, in most contexts, it will not be the case that node labels will be identical. Especially in the context of cyber security, it is easily possible for two nodes in a DAG to represent the same idea but presented in a radically different manner. As such, the distance between attack trees must have a mechanism to account for the similarity between node labels on the basis of their meaning.

% \subsubsection{Order of children}
% \label{sssec:order-of-children}

% It is a known problem that tree edit distance of unordered trees is an \textit{NP}-Complete problem~\cite{zhang_editing_1992}. However, attack trees are unique in that the order of children is dependent on the refinement of the parent node. As such, the distance between attack trees must be able to account for the order of children in the context of the refinement of the parent node. In the case of \AND\ and \OR\ refinements, the children are unordered. However, in the case of \SAND\ (\emph{Sequential} \AND) refinements, the order of children is important. As such, the edit distance between two attack trees must optimize to allow for the reordering of nodes when calculating the edit distance; however, this optimization must be such that it is selectively applicable, and can be not applied in the case of \SAND\ refinements.

% \subsubsection{Metric}
% \label{sssec:metric}

% The distance between two attack trees must be a metric. That is to say, the distance between two attack trees must be non-negative, symmetric, and satisfy the triangle inequality.



% \subsubsection{Consensus Trees}
% \label{sssec:consensus-trees}

% \NS{I dunno if this should be included in this paper - but it'd make it SO MUCH EASIER to argue utility}


% One potential utility of tree edit distance would be to allow for the recognition missing vectors or components of attack trees \NS{cite AG distance paper}. For example, if we find that one tree is a whole subset of another tree, that is the consensus tree between two trees is equivalent to one of the trees, then we can infer that the components of the larger tree are components that would be directly applicable to the subset tree. As such, we can use this method of calculating a consensus tree to find missing components of attack trees.